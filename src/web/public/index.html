<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Database Engine - Management Console</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-database"></i>
                <h1>Custom Database Engine</h1>
            </div>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="openCreateDatabaseModal()">
                    <i class="fas fa-plus"></i> New Database
                </button>
                <div class="status-indicator" id="statusIndicator">
                    <i class="fas fa-circle"></i>
                    <span>Connected</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-server"></i> Databases</h3>
            <button class="btn-icon" onclick="refreshDatabases()">
                <i class="fas fa-sync-alt"></i>
            </button>
        </div>
        
        <div class="database-list" id="databaseList">
            <div class="database-item active" data-db="main">
                <div class="database-header" onclick="toggleDatabase('main')">
                    <i class="fas fa-database"></i>
                    <span>Main Database</span>
                    <i class="fas fa-chevron-down toggle-icon"></i>
                </div>
                <div class="table-list" id="tableList-main">
                    <!-- Tables will be loaded dynamically -->
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('overview')">
                <i class="fas fa-chart-pie"></i> Overview
            </button>
            <button class="tab-btn" onclick="showTab('tables')">
                <i class="fas fa-table"></i> Tables
            </button>
            <button class="tab-btn" onclick="showTab('query')">
                <i class="fas fa-code"></i> SQL Query
            </button>
            <button class="tab-btn" onclick="showTab('transactions')">
                <i class="fas fa-exchange-alt"></i> Transactions
            </button>
        </div>

        <!-- Tab Contents -->
        <div class="tab-content">
            <!-- Overview Tab -->
            <div id="overview" class="tab-pane active">
                <div class="overview-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-table"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="tableCount">0</h3>
                            <p>Tables</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="recordCount">0</h3>
                            <p>Records</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-memory"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="bufferHitRate">0%</h3>
                            <p>Buffer Hit Rate</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="activeTransactions">0</h3>
                            <p>Active Transactions</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>Database Schema</h2>
                    <div class="schema-container" id="schemaContainer">
                        <!-- Schema will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Tables Tab -->
            <div id="tables" class="tab-pane">
                <div class="section-header">
                    <h2>Table Management</h2>
                    <button class="btn btn-primary" onclick="openCreateTableModal()">
                        <i class="fas fa-plus"></i> Create Table
                    </button>
                </div>
                
                <div class="tables-grid" id="tablesGrid">
                    <!-- Tables will be loaded here -->
                </div>
            </div>

            <!-- Query Tab -->
            <div id="query" class="tab-pane">
                <div class="query-section">
                    <div class="query-editor">
                        <div class="editor-header">
                            <h3>SQL Query Editor</h3>
                            <div class="editor-actions">
                                <button class="btn btn-secondary" onclick="formatQuery()">
                                    <i class="fas fa-magic"></i> Format
                                </button>
                                <button class="btn btn-primary" onclick="executeQuery()">
                                    <i class="fas fa-play"></i> Execute
                                </button>
                            </div>
                        </div>
                        <textarea id="queryEditor" placeholder="Enter your SQL query here...&#10;&#10;Examples:&#10;SELECT * FROM users WHERE age > 25;&#10;INSERT INTO users (name, email, age) VALUES ('John', 'john@example.com', 30);&#10;CREATE TABLE products (id INT PRIMARY KEY, name VARCHAR(100), price DECIMAL(10,2));"></textarea>
                    </div>
                    
                    <div class="query-results" id="queryResults">
                        <div class="results-header">
                            <h3>Results</h3>
                            <div class="results-actions" id="resultsActions" style="display: none;">
                                <button class="btn btn-secondary" onclick="exportResults('json')">
                                    <i class="fas fa-download"></i> Export JSON
                                </button>
                                <button class="btn btn-secondary" onclick="exportResults('csv')">
                                    <i class="fas fa-file-csv"></i> Export CSV
                                </button>
                            </div>
                        </div>
                        <div class="results-content" id="resultsContent">
                            <div class="results-placeholder">
                                <i class="fas fa-search"></i>
                                <p>Execute a query to see results here</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transactions Tab -->
            <div id="transactions" class="tab-pane">
                <div class="section-header">
                    <h2>Transaction Management</h2>
                    <button class="btn btn-primary" onclick="startTransaction()">
                        <i class="fas fa-plus"></i> Start Transaction
                    </button>
                </div>
                
                <div class="transactions-list" id="transactionsList">
                    <!-- Active transactions will be listed here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    
    <!-- Create Database Modal -->
    <div id="createDatabaseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Database</h3>
                <button class="btn-close" onclick="closeModal('createDatabaseModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="createDatabaseForm">
                    <div class="form-group">
                        <label for="databaseName">Database Name</label>
                        <input type="text" id="databaseName" placeholder="Enter database name" required>
                    </div>
                    <div class="form-group">
                        <label for="databaseDescription">Description (Optional)</label>
                        <textarea id="databaseDescription" placeholder="Enter database description"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createDatabaseModal')">Cancel</button>
                <button class="btn btn-primary" onclick="createDatabase()">Create</button>
            </div>
        </div>
    </div>

    <!-- Create Table Modal -->
    <div id="createTableModal" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Create New Table</h3>
                <button class="btn-close" onclick="closeModal('createTableModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="createTableForm">
                    <div class="form-group">
                        <label for="tableName">Table Name</label>
                        <input type="text" id="tableName" placeholder="Enter table name" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Columns</label>
                        <div class="columns-container" id="columnsContainer">
                            <div class="column-row">
                                <input type="text" placeholder="Column name" class="column-name" required>
                                <select class="column-type">
                                    <option value="INT">INT</option>
                                    <option value="VARCHAR(255)">VARCHAR(255)</option>
                                    <option value="TEXT">TEXT</option>
                                    <option value="DECIMAL(10,2)">DECIMAL(10,2)</option>
                                    <option value="BOOLEAN">BOOLEAN</option>
                                    <option value="DATE">DATE</option>
                                    <option value="DATETIME">DATETIME</option>
                                </select>
                                <label>
                                    <input type="checkbox" class="column-primary"> Primary Key
                                </label>
                                <label>
                                    <input type="checkbox" class="column-nullable"> Nullable
                                </label>
                                <button type="button" class="btn-icon btn-danger" onclick="removeColumn(this)">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="addColumn()">
                            <i class="fas fa-plus"></i> Add Column
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <label>Generated SQL</label>
                        <textarea id="generatedSQL" readonly placeholder="SQL will be generated here..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('createTableModal')">Cancel</button>
                <button class="btn btn-primary" onclick="createTable()">Create Table</button>
            </div>
        </div>
    </div>

    <!-- Table Data Modal -->
    <div id="tableDataModal" class="modal">
        <div class="modal-content xlarge">
            <div class="modal-header">
                <h3 id="tableDataTitle">Table Data</h3>
                <button class="btn-close" onclick="closeModal('tableDataModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="table-data-content" id="tableDataContent">
                    <!-- Table data will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading...</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
